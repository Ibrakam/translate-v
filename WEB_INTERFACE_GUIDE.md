# Video Translation Web Interface

## –û–±–∑–æ—Ä

–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏ –∏ –¥—É–±–ª—è–∂–∞ –≤–∏–¥–µ–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º AI –∏ –æ–±–ª–∞—á–Ω–æ–≥–æ lip sync.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üì§ –ó–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä
- üéôÔ∏è –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è (Whisper)
- üåç –ü–µ—Ä–µ–≤–æ–¥ —Å—É–±—Ç–∏—Ç—Ä–æ–≤ (DeepL API)
- üó£Ô∏è –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥—É–±–ª—è–∂–∞ (ElevenLabs TTS)
- üíã Lip sync –Ω–∞ –æ–±–ª–∞—á–Ω–æ–º GPU (Replicate API)
- üìä –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- üì• –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Replicate API (–¥–ª—è –æ–±–ª–∞—á–Ω–æ–≥–æ lip sync)

Replicate –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ—â–Ω—ã–µ GPU –Ω–∞ –æ–±–ª–∞–∫–µ –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è.

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ https://replicate.com
2. –ü–æ–ª—É—á–∏—Ç–µ API –∫–ª—é—á: https://replicate.com/account/api-tokens
3. –î–æ–±–∞–≤—å—Ç–µ –∫–ª—é—á –≤ `.env`:

```bash
REPLICATE_API_TOKEN=r8_–≤–∞—à_–∫–ª—é—á_–∑–¥–µ—Å—å
```

**–°—Ç–æ–∏–º–æ—Å—Ç—å**: ~$0.02-0.05 –∑–∞ –º–∏–Ω—É—Ç—É –≤–∏–¥–µ–æ (–æ–ø–ª–∞—Ç–∞ –ø–æ —Ñ–∞–∫—Ç—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥—Ä—É–≥–∏–µ API –∫–ª—é—á–∏ –≤ .env

–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —É –≤–∞—Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã:
- `DEEPL_API_KEY` - –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞
- `ELEVENLABS_API_KEY` - –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≥–æ–ª–æ—Å–∞

### 3. –ó–∞–ø—É—Å–∫ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞

```bash
# –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
source .venv/bin/activate

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä
cd /Users/ibragimkadamzanov/PycharmProjects/translate-v
python app/web_server.py
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ uvicorn –Ω–∞–ø—Ä—è–º—É—é:

```bash
uvicorn app.web_server:app --host 0.0.0.0 --port 8000 --reload
```

### 4. –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ

```
http://localhost:8000
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. **–í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫** –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞ (Spanish, German, French, –∏ —Ç.–¥.)
2. **–ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∏–¥–µ–æ** (–Ω–∞–∂–º–∏—Ç–µ "Select Video File")
3. **–ù–∞–∂–º–∏—Ç–µ "Start Processing"**
4. **–°–ª–µ–¥–∏—Ç–µ –∑–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º** –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
5. **–°–∫–∞—á–∞–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** –∫–æ–≥–¥–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
–ë—Ä–∞—É–∑–µ—Ä ‚Üí FastAPI ‚Üí Pipeline
                    ‚Üì
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ               ‚îÇ               ‚îÇ
Whisper         DeepL         ElevenLabs
(–ª–æ–∫–∞–ª—å–Ω–æ)    (API)           (API)
                              ‚Üì
                        Dubbed Audio
                              ‚Üì
                        Replicate API
                        (Cloud GPU)
                              ‚Üì
                        Lip-Synced Video
```

## –≠—Ç–∞–ø—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏

1. **Audio Extraction** (0-10%) - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞—É–¥–∏–æ –∏–∑ –≤–∏–¥–µ–æ
2. **Transcription** (10-30%) - –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏ —Å Whisper
3. **Translation** (30-40%) - –ü–µ—Ä–µ–≤–æ–¥ —Å—É–±—Ç–∏—Ç—Ä–æ–≤ —Å DeepL
4. **TTS Generation** (40-60%) - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥—É–±–ª—è–∂–∞ —Å ElevenLabs
5. **Lip Sync** (60-100%) - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≥—É–± –Ω–∞ –æ–±–ª–∞—á–Ω–æ–º GPU

## API Endpoints

### POST /upload
–ó–∞–≥—Ä—É–∑–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–∏–¥–µ–æ

**Request:**
```
POST /upload
Content-Type: multipart/form-data

file: video file
language: target language code (ES, DE, FR, etc.)
```

**Response:**
```json
{
  "job_id": "uuid",
  "status": "processing"
}
```

### WebSocket /ws/{job_id}
–ü–æ–ª—É—á–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

**Messages:**
```json
{
  "progress": 45,
  "stage": "TTS Generation",
  "status": "Generating Spanish audio..."
}
```

### GET /download/{filename}
–°–∫–∞—á–∏–≤–∞–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

### GET /status/{job_id}
–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–¥–∞—á–∏

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

**–í–∏–¥–µ–æ:** MP4, AVI, MOV, MKV
**–ê—É–¥–∏–æ:** MP3, WAV, M4A

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –æ–±–ª–∞—á–Ω–æ–≥–æ lip sync

### –ë–µ–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ GPU:
- ‚ùå –ú–µ–¥–ª–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ CPU (10+ –º–∏–Ω—É—Ç –Ω–∞ –º–∏–Ω—É—Ç—É –≤–∏–¥–µ–æ)
- ‚ùå –¢—Ä–µ–±—É–µ—Ç—Å—è –º–æ—â–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
- ‚ùå –ù–∞–≥—Ä–µ–≤ –∏ –∏–∑–Ω–æ—Å –∫–æ–º–ø—å—é—Ç–µ—Ä–∞

### –° –æ–±–ª–∞—á–Ω—ã–º GPU (Replicate):
- ‚úÖ –ë—ã—Å—Ç—Ä–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (1-2 –º–∏–Ω—É—Ç—ã –Ω–∞ –º–∏–Ω—É—Ç—É –≤–∏–¥–µ–æ)
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è GPU
- ‚úÖ –û–ø–ª–∞—Ç–∞ —Ç–æ–ª—å–∫–æ –∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –æ–±–ª–∞—á–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã

–ï—Å–ª–∏ Replicate –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

1. **RunPod** (https://runpod.io)
2. **Lambda Labs** (https://lambdalabs.com)
3. **Modal** (https://modal.com)

–î–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å–æ–∑–¥–∞–π—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –º–æ–¥—É–ª—å –≤ `app/pipeline/lipsync_*.py`

## Troubleshooting

### "Replicate API key not configured"
–î–æ–±–∞–≤—å—Ç–µ –∫–ª—é—á –≤ `.env`:
```bash
REPLICATE_API_TOKEN=r8_–≤–∞—à_–∫–ª—é—á
```

### "WebSocket connection failed"
–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—Ç—É (8000)

### "Upload failed"
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è < 100MB) –∏ —Ñ–æ—Ä–º–∞—Ç

### Lip sync –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–ª–∞–Ω—Å Replicate API: https://replicate.com/account/billing

## –°—Ç–æ–∏–º–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ (–ø—Ä–∏–º–µ—Ä–Ω–æ)

–î–ª—è –≤–∏–¥–µ–æ 1 –º–∏–Ω—É—Ç–∞:
- Whisper (–ª–æ–∫–∞–ª—å–Ω–æ): –±–µ—Å–ø–ª–∞—Ç–Ω–æ
- DeepL API: ~$0.01
- ElevenLabs TTS: ~$0.15-0.30
- Replicate Lip Sync: ~$0.02-0.05

**–ò—Ç–æ–≥–æ: ~$0.18-0.36 –∑–∞ –º–∏–Ω—É—Ç—É –≤–∏–¥–µ–æ**

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è production

### 1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS

```bash
uvicorn app.web_server:app --host 0.0.0.0 --port 443 --ssl-keyfile key.pem --ssl-certfile cert.pem
```

### 2. –î–æ–±–∞–≤—å—Ç–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ FastAPI dependencies –¥–ª—è auth:
```python
from fastapi import Depends, HTTPException, status
from fastapi.security import HTTPBearer

security = HTTPBearer()

@app.post("/upload")
async def upload_video(token: str = Depends(security)):
    # Verify token
    ...
```

### 3. –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤

```python
from fastapi import UploadFile, File

@app.post("/upload")
async def upload_video(file: UploadFile = File(..., max_length=100 * 1024 * 1024)):  # 100MB
    ...
```

### 4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Redis –¥–ª—è –æ—á–µ—Ä–µ–¥–∏ –∑–∞–¥–∞—á

```bash
pip install redis celery
```

### 5. Deploy –Ω–∞ –æ–±–ª–∞–∫–æ

- **Heroku**: `heroku create && git push heroku main`
- **Railway**: https://railway.app
- **Render**: https://render.com
- **DigitalOcean App Platform**

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–î–æ–±–∞–≤—å—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–µ—Ç—Ä–∏–∫–∏:

```python
from prometheus_client import Counter, Histogram

videos_processed = Counter('videos_processed_total', 'Total videos processed')
processing_time = Histogram('video_processing_seconds', 'Time spent processing video')
```

## –õ–∏—Ü–µ–Ω–∑–∏—è

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã:
- OpenAI Whisper (MIT)
- DeepL API (Commercial)
- ElevenLabs API (Commercial)
- Replicate API (Commercial)
- Video Retalking (Research purposes)

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–í–æ–ø—Ä–æ—Å—ã? –°–æ–∑–¥–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –∏–ª–∏ —Å–≤—è–∂–∏—Ç–µ—Å—å —Å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–º.
